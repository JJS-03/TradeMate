
@baseUrl = http://localhost:8080
@email = seller1@test.com
@password = 12345678
@otherEmail = buyer1@test.com
@otherPassword = 12345678
# 로그인 후 발급된 token(eyJ...)을 아래에 붙여넣으세요. (Bearer 제외)
@accessToken = eyJhbGciOiJIUzM4NCJ9.eyJzdWIiOiI2IiwiZW1haWwiOiJzZWxsZXIxQHRlc3QuY29tIiwiaWF0IjoxNzcxNDkxMjA0LCJleHAiOjE3NzE0OTQ4MDR9._wurz3Dsm6UcQ4q5ago9bj8BYBr460933Uuo2D-tY_d5nKsr8ecY8icEwgvTPlrU
@otherAccessToken = eyJhbGciOiJIUzM4NCJ9.eyJzdWIiOiI3IiwiZW1haWwiOiJidXllcjFAdGVzdC5jb20iLCJpYXQiOjE3NzE0OTEyMzQsImV4cCI6MTc3MTQ5NDgzNH0.rJycR2oSXmDjzGJS1jgAHg_nc_RRjNUxe7uVstd6e1IHjhKPLFZFb4NMGGbrZq13
# 반드시 seller1이 아닌 다른 계정의 토큰을 넣으세요. (같은 계정 토큰이면 7번도 200)
@existingItemId = 28
# 5-1 응답의 id 값을 아래 existingItemId에 수동으로 넣어주세요 (미설정 시 6,7도 404)
@notFoundItemId = 999999

### 0) 회원가입 (최초 1회만 실행)
### 이미 가입된 이메일이면 409(DUPLICATE_EMAIL)가 정상입니다.
POST {{baseUrl}}/api/users/signup
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}",
  "nickname": "seller1"
}

### 1) 로그인 (항상 이 요청으로 토큰 재발급)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

### 1-1) 다른 유저 회원가입 (403 테스트용, 최초 1회)
POST {{baseUrl}}/api/users/signup
Content-Type: application/json

{
  "email": "{{otherEmail}}",
  "password": "{{otherPassword}}",
  "nickname": "buyer1"
}

### 1-2) 다른 유저 로그인 (otherAccessToken 수동 갱신)
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "{{otherEmail}}",
  "password": "{{otherPassword}}"
}

### 응답 token 값을 @otherAccessToken에 붙여넣으세요.

### 2) 상품 등록 (정상: 201)
### 주의: accessToken에는 Bearer 없이 '토큰 문자열만' 저장되어야 함
POST {{baseUrl}}/api/items
Content-Type: application/json
Authorization: Bearer {{accessToken}}
# 만약 여전히 401이면 로그인 응답의 token(eyJ...)만 복사해 아래 Authorization 헤더의 {{accessToken}} 값으로 사용

{
  "title": "아이폰 14",
  "description": "거의 새 상품입니다.",
  "price": 900000
}

### 3) 상품 등록 (Authorization 누락: 401)
POST {{baseUrl}}/api/items
Content-Type: application/json

{
  "title": "맥북 프로",
  "description": "M1 16인치",
  "price": 1800000
}

### 4) 상품 등록 (title 공백: 400)
POST {{baseUrl}}/api/items
Content-Type: application/json
Authorization: Bearer {{accessToken}}
# 만약 여전히 401이면 로그인 응답의 token(eyJ...)만 복사해 아래 Authorization 헤더의 {{accessToken}} 값으로 사용

{
  "title": "",
  "description": "제목 누락 테스트",
  "price": 10000
}

### 5-1) 상품 등록 (수정 테스트용 ID 확보: 201)
# @name createItemForUpdate
POST {{baseUrl}}/api/items
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "title": "수정 테스트 원본",
  "description": "수정 전 설명",
  "price": 500000
}


### 6) 상품 수정 (정상: 200)
# 5-1 실행 후 응답의 id를 existingItemId에 넣고 실행하세요.
# (REST Client 확장 지원 시: {{createItemForUpdate.response.body.id}} 사용 가능)
PUT {{baseUrl}}/api/items/{{existingItemId}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "title": "아이폰 14 Pro",
  "description": "수정된 설명입니다.",
  "price": 950000
}

### 7) 상품 수정 (다른 유저: 403)
# otherAccessToken에 seller와 다른 계정 토큰을 넣어야 403이 나옵니다. (같은 토큰이면 200)
PUT {{baseUrl}}/api/items/{{existingItemId}}
Content-Type: application/json
Authorization: Bearer {{otherAccessToken}}

{
  "title": "권한 없는 수정",
  "description": "다른 유저 수정 시도",
  "price": 100000
}

### 8) 상품 수정 (존재하지 않는 상품: 404)
PUT {{baseUrl}}/api/items/{{notFoundItemId}}
Content-Type: application/json
Authorization: Bearer {{accessToken}}

{
  "title": "없는 상품 수정",
  "description": "404 테스트",
  "price": 100000
}

### 9) 상품 삭제 (정상: 204)
DELETE {{baseUrl}}/api/items/{{existingItemId}}
Authorization: Bearer {{accessToken}}

### 10) 상품 삭제 (다른 유저: 403)
DELETE {{baseUrl}}/api/items/{{existingItemId}}
Authorization: Bearer {{otherAccessToken}}

### 11) 상품 삭제 (존재하지 않는 상품: 404)
DELETE {{baseUrl}}/api/items/{{notFoundItemId}}
Authorization: Bearer {{accessToken}}